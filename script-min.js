document.addEventListener("DOMContentLoaded",function(){function f(a){a=a.toString();for(var t=/(-?\d+)(\d{3})/;t.test(a);)a=a.replace(t,"$1,$2");return a}var C=function(a){var t=["th","st","nd","rd"],e=a%100;return a+(t[(e-20)%10]||t[e]||t[0])},m="Hawaii",a=new URLSearchParams(window.location.search).get("state");if(a&&"Hawaii"!==(m=a)){var t=document.querySelector("#hawaiiSpecificInfo");t.parentNode.removeChild(t);var e=document.querySelector("#hiDeptHealth");e.parentNode.removeChild(e)}document.getElementById("stateName").innerHTML=m;var s=new XMLHttpRequest;if(s.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var a=Papa.parse(this.responseText),t={labels:[],datasets:[{label:"Cases",data:[],borderColor:"rgba(217, 136, 128,1)",backgroundColor:"rgba(217, 136, 128,0.2)"},{label:"Deaths",data:[],borderColor:"rgba(240, 178, 122,1)",backgroundColor:"rgba(240, 178, 122,0.2)"}]},e={},s={cases:{beginDate:null,days:null},deaths:{beginDate:null,days:null}};a.data.forEach(function(a){a[1]===m&&(t.labels.includes(a[0])||t.labels.push(a[0]),t.datasets[0].data.push({x:a[0],y:a[3]}),t.datasets[1].data.push({x:a[0],y:a[4]}),s.cases.beginDate||1<=a[3]&&(s.cases.beginDate=a[0]),s.deaths.beginDate||1<=a[4]&&(s.deaths.beginDate=a[0])),e[a[1]]={state:a[1],cases:parseInt(a[3]),deaths:parseInt(a[4])}});var d=Object.values(e);d.sort(function(a,t){return t.cases-a.cases}),d.shift();var n=Object.values(e);n.sort(function(a,t){return t.deaths-a.deaths}),n.shift();var o={cases:{rank:null,total:d.length},deaths:{rank:null,total:d.length}};d.forEach(function(a,t){a.state===m&&(o.cases.rank=t+1)}),n.forEach(function(a,t){a.state===m&&(o.deaths.rank=t+1)}),document.getElementById("caseRanking").innerHTML=m+" is ranked "+C(o.cases.rank)+" out of "+o.cases.total+" states & territories.",document.getElementById("deathRanking").innerHTML=m+" is ranked "+C(o.deaths.rank)+" out of "+o.cases.total+" states & territories.",s.cases.beginDate||(s.cases.beginDate=new Date),s.deaths.beginDate||(s.deaths.beginDate=new Date);var l=moment(new Date);s.cases.days=l.diff(s.cases.beginDate,"days"),s.deaths.days=l.diff(s.deaths.beginDate,"days");var c=document.getElementById("caseDays");c.innerHTML=s.cases.days+" "+(1===s.cases.days?"day":"days")+" since the first case was reported.";var i=document.getElementById("deathDays");i.innerHTML=s.deaths.days+" "+(1===s.deaths.days?"day":"days")+" since the first death was reported.";var r=t.datasets[0].data[t.datasets[0].data.length-1].y-t.datasets[0].data[t.datasets[0].data.length-2].y,h=document.getElementById("caseDiffFromPrevDay");h.innerHTML="("+(0<r?"^":"")+f(r)+")",r<=0?h.classList.add("less"):h.classList.add("more"),new CountUp("cases",0,t.datasets[0].data[t.datasets[0].data.length-1].y).start(function(){h.classList.add("show"),c.classList.add("show"),document.getElementById("caseRanking").classList.add("show")});var u=t.datasets[1].data[t.datasets[1].data.length-1].y-t.datasets[1].data[t.datasets[1].data.length-2].y,g=document.getElementById("deathDiffFromPrevDay");g.innerHTML="("+(0<u?"^":"")+f(u)+")",u<=0?g.classList.add("less"):g.classList.add("more"),new CountUp("deaths",0,t.datasets[1].data[t.datasets[1].data.length-1].y).start(function(){g.classList.add("show"),i.classList.add("show"),document.getElementById("deathRanking").classList.add("show")});var y=document.getElementById("state"),b=(new Chart(y,{type:"line",data:t,options:{title:{display:!0,fontColor:"#FFF",fontSize:20,text:"Cases and Deaths - State of "+m},legend:{labels:{fontColor:"#fff",fontStyle:"bold"}},scales:{yAxes:[{gridLines:{color:"rgba(255,255,255,0.3)"},ticks:{color:"rgba(255,255,255,0.3)",fontColor:"#fff"}}],xAxes:[{gridLines:{color:"rgba(255,255,255,0.3)"},ticks:{color:"rgba(255,255,255,0.3)",fontColor:"#fff"}}]}}}),a.data[a.data.length-1][0]);document.getElementById("stateUpdate").innerHTML="Updated "+b}},s.open("GET","https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-states.csv",!0),s.send(),"Hawaii"===m){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var a=Papa.parse(this.responseText),t={cases:{labels:[],datasets:[{label:"Hawaii",data:[],borderColor:"rgba(217, 136, 128,1)",backgroundColor:"rgba(217, 136, 128,0.2)"},{label:"Honolulu",data:[],borderColor:"rgba(247, 220, 111,1)",backgroundColor:"rgba(247, 220, 111,0.2)"},{label:"Kauai",data:[],borderColor:"rgba(187, 143, 206,1)",backgroundColor:"rgba(187, 143, 206,0.2)"},{label:"Maui",data:[],borderColor:"rgba(125, 206, 160,1)",backgroundColor:"rgba(125, 206, 160,0.2)"}]},deaths:{labels:[],datasets:[{label:"Hawaii",data:[],borderColor:"rgba(217, 136, 128,1)",backgroundColor:"rgba(217, 136, 128,0.2)"},{label:"Honolulu",data:[],borderColor:"rgba(247, 220, 111,1)",backgroundColor:"rgba(247, 220, 111,0.2)"},{label:"Kauai",data:[],borderColor:"rgba(187, 143, 206,1)",backgroundColor:"rgba(187, 143, 206,0.2)"},{label:"Maui",data:[],borderColor:"rgba(125, 206, 160,1)",backgroundColor:"rgba(125, 206, 160,0.2)"}]}};a.data.forEach(function(a){"Hawaii"!==a[1]&&"Honolulu"!==a[1]&&"Kauai"!==a[1]&&"Maui"!==a[1]||(t.cases.labels.includes(a[0])||t.cases.labels.push(a[0]),t.cases.labels.includes(a[0])||t.cases.labels.push(a[0]),t.deaths.labels.includes(a[0])||t.deaths.labels.push(a[0]),t.deaths.labels.includes(a[0])||t.deaths.labels.push(a[0]),"Hawaii"===a[1]&&(t.cases.datasets[0].data.push({x:a[0],y:a[4]}),t.deaths.datasets[0].data.push({x:a[0],y:a[5]})),"Honolulu"===a[1]&&(t.cases.datasets[1].data.push({x:a[0],y:a[4]}),t.deaths.datasets[1].data.push({x:a[0],y:a[5]})),"Kauai"===a[1]&&(t.cases.datasets[2].data.push({x:a[0],y:a[4]}),t.deaths.datasets[2].data.push({x:a[0],y:a[5]})),"Maui"===a[1]&&(t.cases.datasets[3].data.push({x:a[0],y:a[4]}),t.deaths.datasets[3].data.push({x:a[0],y:a[5]})))});var e=document.getElementById("countyCases"),s=(new Chart(e,{type:"line",data:t.cases,options:{title:{display:!0,fontColor:"#FFF",fontSize:20,text:"Cases - State of Hawaii Counties"},legend:{labels:{fontColor:"#fff",fontStyle:"bold"}},scales:{yAxes:[{gridLines:{color:"rgba(255,255,255,0.3)"},ticks:{color:"rgba(255,255,255,0.3)",fontColor:"#fff"}}],xAxes:[{gridLines:{color:"rgba(255,255,255,0.3)"},ticks:{color:"rgba(255,255,255,0.3)",fontColor:"#fff"}}]}}}),document.getElementById("countyDeaths")),d=(new Chart(s,{type:"line",data:t.deaths,options:{title:{display:!0,fontColor:"#FFF",fontSize:20,text:"Deaths - State of Hawaii Counties"},legend:{labels:{fontColor:"#fff",fontStyle:"bold"}},scales:{yAxes:[{gridLines:{color:"rgba(255,255,255,0.3)"},ticks:{color:"rgba(255,255,255,0.3)",fontColor:"#fff",beginAtZero:!0}}],xAxes:[{gridLines:{color:"rgba(255,255,255,0.3)"},ticks:{color:"rgba(255,255,255,0.3)",fontColor:"#fff"}}]}}}),a.data[a.data.length-1][0]);document.getElementById("countyCaseUpdate").innerHTML="Updated "+d,document.getElementById("countyDeathUpdate").innerHTML="Updated "+d;var n={hawaii:{cases:{total:t.cases.datasets[0].data[t.cases.datasets[0].data.length-1].y,change:t.cases.datasets[0].data[t.cases.datasets[0].data.length-1].y-t.cases.datasets[0].data[t.cases.datasets[0].data.length-2].y},deaths:{total:t.deaths.datasets[0].data[t.deaths.datasets[0].data.length-1].y,change:t.deaths.datasets[0].data[t.deaths.datasets[0].data.length-1].y-t.deaths.datasets[0].data[t.deaths.datasets[0].data.length-2].y}},honolulu:{cases:{total:t.cases.datasets[1].data[t.cases.datasets[1].data.length-1].y,change:t.cases.datasets[1].data[t.cases.datasets[1].data.length-1].y-t.cases.datasets[1].data[t.cases.datasets[1].data.length-2].y},deaths:{total:t.deaths.datasets[1].data[t.deaths.datasets[1].data.length-1].y,change:t.deaths.datasets[1].data[t.deaths.datasets[1].data.length-1].y-t.deaths.datasets[1].data[t.deaths.datasets[1].data.length-2].y}},kauai:{cases:{total:t.cases.datasets[2].data[t.cases.datasets[2].data.length-1].y,change:t.cases.datasets[2].data[t.cases.datasets[2].data.length-1].y-t.cases.datasets[2].data[t.cases.datasets[2].data.length-2].y},deaths:{total:t.deaths.datasets[2].data[t.deaths.datasets[2].data.length-1].y,change:t.deaths.datasets[2].data[t.deaths.datasets[2].data.length-1].y-t.deaths.datasets[2].data[t.deaths.datasets[2].data.length-2].y}},maui:{cases:{total:t.cases.datasets[3].data[t.cases.datasets[3].data.length-1].y,change:t.cases.datasets[3].data[t.cases.datasets[3].data.length-1].y-t.cases.datasets[3].data[t.cases.datasets[3].data.length-2].y},deaths:{total:t.deaths.datasets[3].data[t.deaths.datasets[3].data.length-1].y,change:t.deaths.datasets[3].data[t.deaths.datasets[3].data.length-1].y-t.deaths.datasets[3].data[t.deaths.datasets[3].data.length-2].y}}},o=document.getElementById("countyCaseCountHawaiiChange");o.innerHTML="("+(0<n.hawaii.cases.change?"^":"")+f(n.hawaii.cases.change)+")",n.hawaii.cases.change<=0?o.classList.add("less"):o.classList.add("more"),new CountUp("countyCaseCountHawaii",0,n.hawaii.cases.total).start(function(){o.classList.add("show")});var l=document.getElementById("countyCaseCountHonoluluChange");l.innerHTML="("+(0<n.honolulu.cases.change?"^":"")+f(n.honolulu.cases.change)+")",n.honolulu.cases.change<=0?l.classList.add("less"):l.classList.add("more"),new CountUp("countyCaseCountHonolulu",0,n.honolulu.cases.total).start(function(){l.classList.add("show")});var c=document.getElementById("countyCaseCountKauaiChange");c.innerHTML="("+(0<n.kauai.cases.change?"^":"")+f(n.kauai.cases.change)+")",n.kauai.cases.change<=0?c.classList.add("less"):c.classList.add("more"),new CountUp("countyCaseCountKauai",0,n.kauai.cases.total).start(function(){c.classList.add("show")});var i=document.getElementById("countyCaseCountMauiChange");i.innerHTML="("+(0<n.maui.cases.change?"^":"")+f(n.maui.cases.change)+")",n.maui.cases.change<=0?i.classList.add("less"):i.classList.add("more"),new CountUp("countyCaseCountMaui",0,n.maui.cases.total).start(function(){i.classList.add("show")});var r=document.getElementById("countyDeathCountHawaiiChange");r.innerHTML="("+(0<n.hawaii.deaths.change?"^":"")+f(n.hawaii.deaths.change)+")",n.hawaii.deaths.change<=0?r.classList.add("less"):r.classList.add("more"),new CountUp("countyDeathCountHawaii",0,n.hawaii.deaths.total).start(function(){r.classList.add("show")});var h=document.getElementById("countyDeathCountHonoluluChange");h.innerHTML="("+(0<n.honolulu.deaths.change?"^":"")+f(n.honolulu.deaths.change)+")",n.honolulu.deaths.change<=0?h.classList.add("less"):h.classList.add("more"),new CountUp("countyDeathCountHonolulu",0,n.honolulu.deaths.total).start(function(){h.classList.add("show")});var u=document.getElementById("countyDeathCountKauaiChange");u.innerHTML="("+(0<n.kauai.deaths.change?"^":"")+f(n.kauai.deaths.change)+")",n.kauai.deaths.change<=0?u.classList.add("less"):u.classList.add("more"),new CountUp("countyDeathCountKauai",0,n.kauai.deaths.total).start(function(){u.classList.add("show")});var g=document.getElementById("countyDeathCountMauiChange");g.innerHTML="("+(0<n.maui.deaths.change?"^":"")+f(n.maui.deaths.change)+")",n.maui.deaths.change<=0?g.classList.add("less"):g.classList.add("more"),new CountUp("countyDeathCountMaui",0,n.maui.deaths.total).start(function(){g.classList.add("show")})}},d.open("GET","https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv",!0),d.send()}});