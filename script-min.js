document.addEventListener("DOMContentLoaded",function(){function f(a){a=a.toString();for(var t=/(-?\d+)(\d{3})/;t.test(a);)a=a.replace(t,"$1,$2");return a}var C=function(a){var t=["th","st","nd","rd"],e=a%100;return a+(t[(e-20)%10]||t[e]||t[0])},D="Hawaii",a=new URLSearchParams(window.location.search).get("state");if(a&&"Hawaii"!==(D=a)){var t=document.querySelector("#hawaiiSpecificInfo");t.parentNode.removeChild(t);var e=document.querySelector("#hiDeptHealth");e.parentNode.removeChild(e)}document.getElementById("stateName").innerHTML=D;var s=new XMLHttpRequest;if(s.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var a=Papa.parse(this.responseText),t={labels:[],datasets:[{label:"Cases",data:[],borderColor:"rgba(217, 136, 128,1)",backgroundColor:"rgba(217, 136, 128,0.2)"},{label:"Deaths",data:[],borderColor:"rgba(240, 178, 122,1)",backgroundColor:"rgba(240, 178, 122,0.2)"}]},e={},s={cases:{beginDate:null,days:null},deaths:{beginDate:null,days:null}};a.data.forEach(function(a){a[1]===D&&(t.labels.includes(a[0])||t.labels.push(a[0]),t.datasets[0].data.push({x:a[0],y:a[3]}),t.datasets[1].data.push({x:a[0],y:a[4]}),s.cases.beginDate||1<=a[3]&&(s.cases.beginDate=a[0]),s.deaths.beginDate||1<=a[4]&&(s.deaths.beginDate=a[0])),e[a[1]]={state:a[1],cases:parseInt(a[3]),deaths:parseInt(a[4])}});var d=Object.values(e);d.sort(function(a,t){return t.cases-a.cases}),d.shift();var n=Object.values(e);n.sort(function(a,t){return t.deaths-a.deaths}),n.shift();var o={cases:{rank:null,total:d.length},deaths:{rank:null,total:d.length}};d.forEach(function(a,t){a.state===D&&(o.cases.rank=t+1)}),n.forEach(function(a,t){a.state===D&&(o.deaths.rank=t+1)}),document.getElementById("caseRanking").innerHTML=D+" is ranked "+C(o.cases.rank)+" out of "+o.cases.total+" states & territories.",document.getElementById("deathRanking").innerHTML=D+" is ranked "+C(o.deaths.rank)+" out of "+o.cases.total+" states & territories.",s.cases.beginDate||(s.cases.beginDate=new Date),s.deaths.beginDate||(s.deaths.beginDate=new Date);var l=moment(new Date);s.cases.days=l.diff(s.cases.beginDate,"days"),s.deaths.days=l.diff(s.deaths.beginDate,"days");var r=document.getElementById("caseDays");r.innerHTML=s.cases.days+" "+(1===s.cases.days?"day":"days")+" since the first case was reported.";var c=document.getElementById("deathDays");c.innerHTML=s.deaths.days+" "+(1===s.deaths.days?"day":"days")+" since the first death was reported.";var i=t.datasets[0].data[t.datasets[0].data.length-1].y-t.datasets[0].data[t.datasets[0].data.length-2].y,h=document.getElementById("caseDiffFromPrevDay");h.innerHTML="("+(0<i?"^":"")+f(i)+")",i<=0?h.classList.add("less"):h.classList.add("more"),new CountUp("cases",0,t.datasets[0].data[t.datasets[0].data.length-1].y).start(function(){h.classList.add("show"),r.classList.add("show"),document.getElementById("caseRanking").classList.add("show")});var u=t.datasets[1].data[t.datasets[1].data.length-1].y-t.datasets[1].data[t.datasets[1].data.length-2].y,g=document.getElementById("deathDiffFromPrevDay");g.innerHTML="("+(0<u?"^":"")+f(u)+")",u<=0?g.classList.add("less"):g.classList.add("more"),new CountUp("deaths",0,t.datasets[1].data[t.datasets[1].data.length-1].y).start(function(){g.classList.add("show"),c.classList.add("show"),document.getElementById("deathRanking").classList.add("show")});var y=document.getElementById("state"),b=(new Chart(y,{type:"line",data:t,options:{title:{display:!0,fontColor:"#FFF",fontSize:20,text:"Cases and Deaths - State of "+D},legend:{labels:{fontColor:"#fff",fontStyle:"bold"}},scales:{yAxes:[{gridLines:{color:"rgba(255,255,255,0.3)"},ticks:{color:"rgba(255,255,255,0.3)",fontColor:"#fff"}}],xAxes:[{gridLines:{color:"rgba(255,255,255,0.3)"},ticks:{color:"rgba(255,255,255,0.3)",fontColor:"#fff"}}]}}}),a.data[a.data.length-1][0]);document.getElementById("stateUpdate").innerHTML="Updated "+b}},s.open("GET","https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-states.csv",!0),s.send(),"Hawaii"===D){var d=new XMLHttpRequest;d.onreadystatechange=function(){function a(a,t,e,s){var d=document.getElementById(s);d.innerHTML="("+(0<o[t][a].change?"^":"")+f(o[t][a].change)+")",o[t][a].change<=0?d.classList.add("less"):d.classList.add("more"),new CountUp(e,0,o[t][a].total).start(function(){d.classList.add("show")})}if(4==this.readyState&&200==this.status){var t=Papa.parse(this.responseText),e={cases:{labels:[],datasets:[{label:"Hawaii",data:[],borderColor:"rgba(217, 136, 128,1)",backgroundColor:"rgba(217, 136, 128,0.2)"},{label:"Honolulu",data:[],borderColor:"rgba(247, 220, 111,1)",backgroundColor:"rgba(247, 220, 111,0.2)"},{label:"Kauai",data:[],borderColor:"rgba(187, 143, 206,1)",backgroundColor:"rgba(187, 143, 206,0.2)"},{label:"Maui",data:[],borderColor:"rgba(125, 206, 160,1)",backgroundColor:"rgba(125, 206, 160,0.2)"}]},deaths:{labels:[],datasets:[{label:"Hawaii",data:[],borderColor:"rgba(217, 136, 128,1)",backgroundColor:"rgba(217, 136, 128,0.2)"},{label:"Honolulu",data:[],borderColor:"rgba(247, 220, 111,1)",backgroundColor:"rgba(247, 220, 111,0.2)"},{label:"Kauai",data:[],borderColor:"rgba(187, 143, 206,1)",backgroundColor:"rgba(187, 143, 206,0.2)"},{label:"Maui",data:[],borderColor:"rgba(125, 206, 160,1)",backgroundColor:"rgba(125, 206, 160,0.2)"}]}};t.data.forEach(function(a){"Hawaii"!==a[1]&&"Honolulu"!==a[1]&&"Kauai"!==a[1]&&"Maui"!==a[1]||(e.cases.labels.includes(a[0])||e.cases.labels.push(a[0]),e.cases.labels.includes(a[0])||e.cases.labels.push(a[0]),e.deaths.labels.includes(a[0])||e.deaths.labels.push(a[0]),e.deaths.labels.includes(a[0])||e.deaths.labels.push(a[0]),"Hawaii"===a[1]&&(e.cases.datasets[0].data.push({x:a[0],y:a[4]}),e.deaths.datasets[0].data.push({x:a[0],y:a[5]})),"Honolulu"===a[1]&&(e.cases.datasets[1].data.push({x:a[0],y:a[4]}),e.deaths.datasets[1].data.push({x:a[0],y:a[5]})),"Kauai"===a[1]&&(e.cases.datasets[2].data.push({x:a[0],y:a[4]}),e.deaths.datasets[2].data.push({x:a[0],y:a[5]})),"Maui"===a[1]&&(e.cases.datasets[3].data.push({x:a[0],y:a[4]}),e.deaths.datasets[3].data.push({x:a[0],y:a[5]})))});var s=document.getElementById("countyCases"),d=(new Chart(s,{type:"line",data:e.cases,options:{title:{display:!0,fontColor:"#FFF",fontSize:20,text:"Cases - State of Hawaii Counties"},legend:{labels:{fontColor:"#fff",fontStyle:"bold"}},scales:{yAxes:[{gridLines:{color:"rgba(255,255,255,0.3)"},ticks:{color:"rgba(255,255,255,0.3)",fontColor:"#fff"}}],xAxes:[{gridLines:{color:"rgba(255,255,255,0.3)"},ticks:{color:"rgba(255,255,255,0.3)",fontColor:"#fff"}}]}}}),document.getElementById("countyDeaths")),n=(new Chart(d,{type:"line",data:e.deaths,options:{title:{display:!0,fontColor:"#FFF",fontSize:20,text:"Deaths - State of Hawaii Counties"},legend:{labels:{fontColor:"#fff",fontStyle:"bold"}},scales:{yAxes:[{gridLines:{color:"rgba(255,255,255,0.3)"},ticks:{color:"rgba(255,255,255,0.3)",fontColor:"#fff",beginAtZero:!0}}],xAxes:[{gridLines:{color:"rgba(255,255,255,0.3)"},ticks:{color:"rgba(255,255,255,0.3)",fontColor:"#fff"}}]}}}),t.data[t.data.length-1][0]);document.getElementById("countyCaseUpdate").innerHTML="Updated "+n,document.getElementById("countyDeathUpdate").innerHTML="Updated "+n;var o={hawaii:{cases:{countDiv:"countyCaseCountHawaiiChange",changeDiv:"countyCaseCountHawaii",total:e.cases.datasets[0].data[e.cases.datasets[0].data.length-1].y,change:e.cases.datasets[0].data[e.cases.datasets[0].data.length-1].y-e.cases.datasets[0].data[e.cases.datasets[0].data.length-2].y},deaths:{countDiv:"countyDeathCountHawaiiChange",changeDiv:"countyDeathCountHawaii",total:e.deaths.datasets[0].data[e.deaths.datasets[0].data.length-1].y,change:e.deaths.datasets[0].data[e.deaths.datasets[0].data.length-1].y-e.deaths.datasets[0].data[e.deaths.datasets[0].data.length-2].y}},honolulu:{cases:{countDiv:"countyCaseCountHonoluluChange",changeDiv:"countyCaseCountHonolulu",total:e.cases.datasets[1].data[e.cases.datasets[1].data.length-1].y,change:e.cases.datasets[1].data[e.cases.datasets[1].data.length-1].y-e.cases.datasets[1].data[e.cases.datasets[1].data.length-2].y},deaths:{countDiv:"countyDeathCountHonoluluChange",changeDiv:"countyDeathCountHonolulu",total:e.deaths.datasets[1].data[e.deaths.datasets[1].data.length-1].y,change:e.deaths.datasets[1].data[e.deaths.datasets[1].data.length-1].y-e.deaths.datasets[1].data[e.deaths.datasets[1].data.length-2].y}},kauai:{cases:{countDiv:"countyCaseCountKauaiChange",changeDiv:"countyCaseCountKauai",total:e.cases.datasets[2].data[e.cases.datasets[2].data.length-1].y,change:e.cases.datasets[2].data[e.cases.datasets[2].data.length-1].y-e.cases.datasets[2].data[e.cases.datasets[2].data.length-2].y},deaths:{countDiv:"countyDeathCountKauaiChange",changeDiv:"countyDeathCountKauai",total:e.deaths.datasets[2].data[e.deaths.datasets[2].data.length-1].y,change:e.deaths.datasets[2].data[e.deaths.datasets[2].data.length-1].y-e.deaths.datasets[2].data[e.deaths.datasets[2].data.length-2].y}},maui:{cases:{countDiv:"countyCaseCountMauiChange",changeDiv:"countyCaseCountMaui",total:e.cases.datasets[3].data[e.cases.datasets[3].data.length-1].y,change:e.cases.datasets[3].data[e.cases.datasets[3].data.length-1].y-e.cases.datasets[3].data[e.cases.datasets[3].data.length-2].y},deaths:{countDiv:"countyDeathCountMauiChange",changeDiv:"countyDeathCountMaui",total:e.deaths.datasets[3].data[e.deaths.datasets[3].data.length-1].y,change:e.deaths.datasets[3].data[e.deaths.datasets[3].data.length-1].y-e.deaths.datasets[3].data[e.deaths.datasets[3].data.length-2].y}}};for(var l in o)o.hasOwnProperty(l)&&(a("cases",l,o[l].cases.changeDiv,o[l].cases.countDiv),a("deaths",l,o[l].deaths.changeDiv,o[l].deaths.countDiv))}},d.open("GET","https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv",!0),d.send()}});